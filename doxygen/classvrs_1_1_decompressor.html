<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VRS: vrs::Decompressor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="VRS-Icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">VRS
   </div>
   <div id="projectbrief">A file format for sensor data.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacevrs.html">vrs</a></li><li class="navelem"><a class="el" href="classvrs_1_1_decompressor.html">Decompressor</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classvrs_1_1_decompressor-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">vrs::Decompressor Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classvrs_1_1_decompressor.html" title="Decompressor helper class, to decompresses data at a target location.">Decompressor</a> helper class, to decompresses data at a target location.  
 <a href="classvrs_1_1_decompressor.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_decompressor_8h_source.html">Decompressor.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvrs_1_1_decompressor_1_1_lz4_decompressor.html">Lz4Decompressor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classvrs_1_1_decompressor.html" title="Decompressor helper class, to decompresses data at a target location.">Decompressor</a> for lz4 data.  <a href="classvrs_1_1_decompressor_1_1_lz4_decompressor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvrs_1_1_decompressor_1_1_zstd_decompressor.html">ZstdDecompressor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classvrs_1_1_decompressor.html" title="Decompressor helper class, to decompresses data at a target location.">Decompressor</a> for zstd data.  <a href="classvrs_1_1_decompressor_1_1_zstd_decompressor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a305bb5117c6529fab0b9a6600f752427"><td class="memItemLeft" align="right" valign="top"><a id="a305bb5117c6529fab0b9a6600f752427"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setCompressionType</b> (<a class="el" href="namespacevrs.html#ac167a592f5255abc1a276d8ed0b96f2f">CompressionType</a> compressionType)</td></tr>
<tr class="separator:a305bb5117c6529fab0b9a6600f752427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b99956025986acccec08062f2ec5b7f"><td class="memItemLeft" align="right" valign="top"><a id="a6b99956025986acccec08062f2ec5b7f"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>getRecommendedInputBufferSize</b> () const</td></tr>
<tr class="separator:a6b99956025986acccec08062f2ec5b7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ef267aebe47b3d781e5add2fe1fbe30"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvrs_1_1_decompressor.html#a0ef267aebe47b3d781e5add2fe1fbe30">decompress</a> (void *destination, uint32_t destinationSize, uint32_t &amp;outReadSize)</td></tr>
<tr class="separator:a0ef267aebe47b3d781e5add2fe1fbe30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a3319233017e6b394f36e2a30a8a86d"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvrs_1_1_decompressor.html#a0a3319233017e6b394f36e2a30a8a86d">allocateCompressedDataBuffer</a> (size_t requestSize)</td></tr>
<tr class="separator:a0a3319233017e6b394f36e2a30a8a86d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf01a8fd299ffb428b2fdecc27fdac91"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvrs_1_1_decompressor.html#acf01a8fd299ffb428b2fdecc27fdac91">getRemainingCompressedDataBufferSize</a> () const</td></tr>
<tr class="separator:acf01a8fd299ffb428b2fdecc27fdac91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa186f022e0d2a7382dbc2356db2dcde9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvrs_1_1_decompressor.html#aa186f022e0d2a7382dbc2356db2dcde9">initFrame</a> (<a class="el" href="classvrs_1_1_file_handler.html">FileHandler</a> &amp;file, size_t &amp;outFrameSize, size_t &amp;inOutMaxReadSize)</td></tr>
<tr class="separator:aa186f022e0d2a7382dbc2356db2dcde9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96ab41eb3bc896368629fd4e7d30c24d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvrs_1_1_decompressor.html#a96ab41eb3bc896368629fd4e7d30c24d">readFrame</a> (<a class="el" href="classvrs_1_1_file_handler.html">FileHandler</a> &amp;file, void *dst, size_t frameSize, size_t &amp;inOutMaxReadSize)</td></tr>
<tr class="separator:a96ab41eb3bc896368629fd4e7d30c24d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b50495c5cd7c0e4321a35770601fc6"><td class="memItemLeft" align="right" valign="top"><a id="a71b50495c5cd7c0e4321a35770601fc6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvrs_1_1_decompressor.html#a71b50495c5cd7c0e4321a35770601fc6">reset</a> ()</td></tr>
<tr class="memdesc:a71b50495c5cd7c0e4321a35770601fc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forget any remaining compressed data, get ready for a new frame. <br /></td></tr>
<tr class="separator:a71b50495c5cd7c0e4321a35770601fc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classvrs_1_1_decompressor.html" title="Decompressor helper class, to decompresses data at a target location.">Decompressor</a> helper class, to decompresses data at a target location. </p>
<p>The data to decompress must be in the internal buffer. Use getBuffer(size) to allocate memory for the internal buffer reserving at least size bytes and get a pointer where to write the data, probably reading from disk directly in that internal buffer. Call decompress to decompress a full record to the <a class="el" href="classvrs_1_1_data_reference.html" title="Container of data pointers, to tell where to write data when reading a record.">DataReference</a> location. The whole record will be decompressed &amp; written at the target location without intermediate memory copy. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a0a3319233017e6b394f36e2a30a8a86d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a3319233017e6b394f36e2a30a8a86d">&#9670;&nbsp;</a></span>allocateCompressedDataBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * vrs::Decompressor::allocateCompressedDataBuffer </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>requestSize</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a buffer of a specific size where to write the data to be decoded. The decompressor will assume that the buffer will be filed to the requested size. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">requestSize</td><td>Size to allocate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the buffer. </dd></dl>

</div>
</div>
<a id="a0ef267aebe47b3d781e5add2fe1fbe30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ef267aebe47b3d781e5add2fe1fbe30">&#9670;&nbsp;</a></span>decompress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vrs::Decompressor::decompress </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>destinationSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t &amp;&#160;</td>
          <td class="paramname"><em>outReadSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decompress a maximum of destinationSize bytes of data, at the pointed to destination, and return the number of bytes read in outReadSize. </p><dl class="section return"><dt>Returns</dt><dd>0 if no error occurred, a file system error code otherwise. </dd></dl>

</div>
</div>
<a id="acf01a8fd299ffb428b2fdecc27fdac91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf01a8fd299ffb428b2fdecc27fdac91">&#9670;&nbsp;</a></span>getRemainingCompressedDataBufferSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t vrs::Decompressor::getRemainingCompressedDataBufferSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Tell how many bytes we haven't yet decoded from our compressed data buffer. </p><dl class="section return"><dt>Returns</dt><dd>Number of bytes. </dd></dl>

</div>
</div>
<a id="aa186f022e0d2a7382dbc2356db2dcde9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa186f022e0d2a7382dbc2356db2dcde9">&#9670;&nbsp;</a></span>initFrame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vrs::Decompressor::initFrame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classvrs_1_1_file_handler.html">FileHandler</a> &amp;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>outFrameSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>inOutMaxReadSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frame compression APIs, to read compressed frames from a file. 1/ call <a class="el" href="classvrs_1_1_decompressor.html#a71b50495c5cd7c0e4321a35770601fc6" title="Forget any remaining compressed data, get ready for a new frame.">reset()</a> (if the compressor was used before). 2/ call initFrame to know how large the uncompressed frame is. 3/ allocate enough memory for the whole frame. 4/ read the whole frame in the buffer 5/ if reading more than one successive frames, <em>do not call reset</em>, go straight back to 2/</p>
<p>Start to read a frame, by sniffing the upcoming frame's size. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>A file open for reading, at the position of the frame. </td></tr>
    <tr><td class="paramname">frameSize</td><td>On success, set to the size in bytes of the upcoming frame. </td></tr>
    <tr><td class="paramname">maxReadSize</td><td>Max number of bytes of compressed frames data. If there are multiple frames, or the size of the compressed frame(s) is unknown, this number maybe the remaining file size. This number is updated as needed, if data is read from the file and placed in an internal decode buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 for success, or an error code. This could happen if you try to read data that isn't a compressed frame. Note that the file might be read past the end of the compressed frame, but not beyond the incoming value of inOutMaxReadSize. So when reading successive frames, do not reset the compression object between frames. Instead, just call initFrame again, after successfully reading a frame. </dd></dl>

</div>
</div>
<a id="a96ab41eb3bc896368629fd4e7d30c24d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96ab41eb3bc896368629fd4e7d30c24d">&#9670;&nbsp;</a></span>readFrame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int vrs::Decompressor::readFrame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classvrs_1_1_file_handler.html">FileHandler</a> &amp;&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>frameSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t &amp;&#160;</td>
          <td class="paramname"><em>inOutMaxReadSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read a compressed frame, all at once. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>A file open for reading, at the position of the frame. </td></tr>
    <tr><td class="paramname">dst</td><td>A pointer to an allocated buffer large enough for the whole frame. </td></tr>
    <tr><td class="paramname">frameSize</td><td>The size of the frame, as returned by initFrame. The buffer must be large enough to read the whole frame at once. </td></tr>
    <tr><td class="paramname">maxReadSize</td><td>Max number of bytes of compressed frames data left. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>vrs/<a class="el" href="_decompressor_8h_source.html">Decompressor.h</a></li>
<li>vrs/Decompressor.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
